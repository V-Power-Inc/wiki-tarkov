# Bitbucket Pipeline file

# This template allows you to validate your PHP application.
# The workflow allows running tests and code linting on the default branch.

pipelines:
  branches:
    docker-release:
      - step:
          name: Build
          runs-on:
            - self.hosted
            - linux
          script:
            - echo "Собираем Docker контейнеры"

            # Запускаем контейнеры приложения в фоновом режиме
            - sudo docker-compose up -d

            - echo "Обновляем зависимости composer"

            # Обновляем зависимости композера
            - sudo docker-compose exec -T app composer install --no-interaction